# 研究成果

## 專題

大三專題獨立實作了一套自動化程式測試之解題平台 (Online Judge)，以下簡稱解題平台。解題平台主要分為三大部分，前端設計、後端 API 與 Judge API，負責確保安全地執行使用者程式碼與比對結果；與四大功能，包含自動化程式測試、前端線上程式編輯器、標籤分類系統、社群系統。

### 程式測試環境

解題平台需要編譯、執行大量使用者的程式，而如何避免使用者惡意的程式碼攻擊伺服器就成為了平台需要面臨的重要課題。解題平台利用開源專案 isolate[^1] 來確保編譯、執行使用者程式碼環境的安全性。isolate 為 International Olympiad in Informatics (IOI)[^2] 所開源，最初使用在 Moe Contest Environment (MOE) ，後來獨立出來的專案，目前也被相當有名的開源Judge (judge0) 所使用。

平台原先使用Python的 FastAPI[^3] 撰寫 API，因為語言特性實作時潛在的 Error 容易被忽略，例如讀寫檔案時發生的 IO Error、字串轉數字時所發生的 ParseError，而導致服務不穩定。
後續為了解決處理 Error Handling 的問題，我重新以 Rust 實作 API 部分。Rust 在處理 Error Handling 的方式與傳統的 Try Catch 機制有很大的不同， Rust 使用的方式是透過 Return `Enum<T, E> { Ok(T), Error(E) }`，發生 Error 可以透過 `match` 的方式處理，此外，得益於 Rust Compiler 嚴格的特性，漏處理的 Error 也會在編譯時期發現。在實作過程中也感受到了 Rust 連續多年在 Stack Overflow Developer Survey 中蟬聯最愛程式語言排行榜冠軍的原因。

### Web 技術

解題平台使用 Next.js[^4] 開發 full-stack web 應用程式，下圖為平台架構圖。

![[架構圖.png|center|550]]

解題平台前端使用 TailwindCSS[^5] 與  shadcn/ui[^6] 來實作，TailwindCSS 是在 GitHub 上擁有高達七萬多 Star，相當火熱的 Utility-first CSS framework 專案，透過將各種 CSS 包裝成 Utility，將 Utility 寫在 Class 中，因此，我們無需在 HTML、CSS 檔案間多次切換，也無需在為取 CSS 類名操心；shadcn/ui 則是今年初才開始的專案，但在短短十個月就在 GitHub 上取得了三萬多 Star，與傳統 Component Library 不同的是，shadcn/ui 為 re-usable components，將 Component 的程式碼都放在網頁中，開發者可以自由地複製、修改到自己的專案中，相比傳統的 Component Library 擁有了更高的自由度。
此外，平台還有使用到 CodeMirror6[^7] 提供線上編輯器功能與透過 Zustand[^8] 管理 React Component State。

後端則是使用了 tRPC[^9] 確保前後端溝通能夠 End-to-end typesafe，透過 Prisma[^10] (Typescript ORM) 擁有資料庫對應的 Model 與 Type，整合 tRPC 與 Prisma 達到從資料庫、後端與三者能夠 End-to-end typesafe。與 RESTful API 使用 JSON 傳輸資料相比，前端在 Parse JSON 時無法得知資料的型別與結構；使用 tRPC 則可以讓 API 如 Function 一般，擁有固定的輸入與輸出型別。

此外還有使用到 lucia-auth[^11] (Auth.js[^12] used before)，透過實作 Custom Database Prisma Adapter，使 lucia-auth 能夠與平台的資料庫溝通，用以實現會員登入功能。

![[Polycarp_s Pockets - WKEJudge.png|center]]


## 研究計畫

### 研究主題

研究主題旨在探索與實作一套 Backend as a Service (BaaS) 平台，研究著重於線上資料庫管理、Authentication 登入驗證與使用者管理以及權限管理三大功能。

### 研究背景
	
在大三時期開發了一套解題平台，接觸到了許多技術、工具，學習到了如何從建立資料庫、設計 Schema 到開發前後端。開發過程中碰到問題、需求，往往會需要從網路上尋找現有的工具，例如平台需要登入功能，發現了 Auth.js (NextAuth) 這個工具，然而使用到新工具時需要閱讀其文檔，有時還因為文檔寫的不完整而必須要閱讀原始碼了解該工具的運作方式，不僅如此，很多時候同時存在多個類型相同的工具，開發時也必須在工具之間抉擇，因此在過程中，容易花費大量時間、成本。

### 研究動機

最近在網路上看到了 Supabase[^13]，Supabase 為 BaaS 平台，平台就有提供線上資料庫管理、支援 Authentication 登入與使用者管理，解決了我先前開發時遇到的痛點。Supabase 還提供了檔案管理、權限管理功能，這些功能的共同點就是在不同 Web 應用程式中的實作往往都大同小異，因此使用該平台可以大大地減少了開發這些功能的時間。基於對其實作細節的興趣，因此想要實作一套相似的平台以及研究這些服務背後的實作原理。

### 研究目的

本研究的目的為開發一套完整的 BaaS 平台，用以減少開發者在開發 Web 應用程式時面臨的繁雜工作，並深入研究與探討一下三大功能

1. 深入研究線上資料庫管理：研究現有資料庫的特性、擴充性，以及如何高效地建立、維護與管理大量資料庫。
2. 研究與探索不同的登入驗證方式，例如 OAuth 2.0 第三方登入、多重要素驗證 (Multi-factor authentication)、通行密鑰 (Passkeys) 等方法，並比較它們的優缺點，以提供多樣的選擇和安全性。
3. 探討權限管理：研究不同的權限控制方法，包括 Role-Based Access Control (RBAC)、Mandatory Access Control (MAC)、Attribute-based Access Control (ABAC)，以及如何實現這些方法來保護應用程式的敏感資料和功能。

[^1]: ioi/isolate (sandbox for securely executing untrusted programs): https://github.com/ioi/isolate
[^2]: International Olympiad in Informatics (IOI): https://ioinformatics.org/
[^3]: FastAPI: https://fastapi.tiangolo.com/
[^4]: Next.js (The React framework for the web): https://nextjs.org/
[^5]: TailwindCSS (A utility-first CSS framework): https://tailwindcss.com/
[^6]: shadcn/ui: https://ui.shadcn.com/
[^7]: CodeMirror6 (Extensible Code Editor): https://codemirror.net/
[^8]: Zustand: https://zustand-demo.pmnd.rs/
[^9]: tRPC (End-to-end typesafe APIs): https://trpc.io/
[^10]: Prisma (Next-generation Node.js and TypeScript ORM): https://www.prisma.io/
[^11]: lucia-auth: https://lucia-auth.com/
[^12]: Auth.js (Authentication for the Web.): https://authjs.dev/
[^13]:  Supabase: https://supabase.com/